# Stale labeler for PRs and issues

# This action will: 
# * Add a label "stale" on issues and PRs after STALE_DAYS of inactivity and comment on them if they also have the "external" label
# * Close the stale issues and pull requests after 7 days of inactivity
# * If an update/comment occur on stale issues or pull requests, the stale label will be removed and the timer will restart if they have the "external" label

# Runs every morning at 1AM: We don't want people having to wait a whole week to get the stale label removed 
# Docs: https://github.com/actions/stale

name: 'Label and close stale issues and PRs'
on:
  schedule:
    - cron: '0 1 * * *'
  workflow_dispatch:
jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v6
        with:
          days-before-stale: ${{ env.STALE_DAYS }}
          days-before-close: ${{ env.CLOSE_AFTER_DAYS }}
          stale-issue-message: >
            There has been no activity on this issue for ${{ env.STALE_DAYS }} days. 
            Labeling as stale and closing in ${{ env.CLOSE_AFTER_DAYS }} days if no further activity.
          stale-pr-message: >
            There has been no activity on this PR for ${{ env.STALE_DAYS }} days. 
            Labeling as stale and closing in ${{ env.CLOSE_AFTER_DAYS }} days if no further activity.
          stale-issue-label: 'stale'
          stale-pr-label: 'stale'
          any-of-labels: 'external'
env:
  STALE_DAYS: 60
  CLOSE_AFTER_DAYS: 7
