2022-05-02T01:57:37.929Z	V4	e2e	Logger init completed	{"vlevel": 4}
=== RUN   TestVSphereKubernetes121BottlerocketTo122WithFluxLegacyUpgrade
2022-05-02T01:57:37.929Z	V2	e2e	Pulling docker image	{"image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.1.0-eks-a-v0.0.0-dev-build.589"}
2022-05-02T01:57:46.843Z	V3	e2e	Initializing long running container	{"name": "eksa_1651456657929825487", "image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.1.0-eks-a-v0.0.0-dev-build.589"}
2022-05-02T01:57:51.054Z	V2	e2e	Pulling docker image	{"image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.1.0-eks-a-v0.0.0-dev-build.589"}
2022-05-02T01:57:52.027Z	V3	e2e	Initializing long running container	{"name": "eksa_1651456671054913177", "image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.1.0-eks-a-v0.0.0-dev-build.589"}
    cluster.go:499: Running shell command [ eksctl anywhere generate clusterconfig main-i-0e227bf076540da53 -p vsphere > cluster.yaml ]
    cluster.go:374: Creating cluster main-i-0e227bf076540da53
    cluster.go:499: Running shell command [ eksctl anywhere create cluster -f main-i-0e227bf076540da53-config/cluster.yaml -v 4 ]
2022-05-02T01:57:56.576Z	V4	Logger init completed	{"vlevel": 4}
2022-05-02T01:57:56.577Z	V0	Warning: The recommended size of an external etcd cluster is 3 or 5
2022-05-02T01:57:56.686Z	V0	Warning: VSphereDatacenterConfig configured in insecure mode
2022-05-02T01:57:56.729Z	V4	Reading bundles manifest	{"url": "https://dev-release-prod-pdx.s3.amazonaws.com/bundle-release.yaml"}
2022-05-02T01:57:56.846Z	V2	Pulling docker image	{"image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.7.2-eks-a-v0.0.0-dev-build.1872"}
2022-05-02T01:58:02.985Z	V3	Initializing long running container	{"name": "eksa_1651456676846185743", "image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.7.2-eks-a-v0.0.0-dev-build.1872"}
2022-05-02T01:58:06.396Z	V4	Checking validity of Github Access Token environment variable	{"env var": "EKSA_GITHUB_TOKEN"}
2022-05-02T01:58:06.680Z	V0	Checking Github Access Token permissions
2022-05-02T01:58:06.680Z	V0	✅ Github personal access token has the required repo permissions
2022-05-02T01:58:06.680Z	V4	Task start	{"task_name": "setup-validate"}
2022-05-02T01:58:06.680Z	V0	Performing setup and validations
2022-05-02T01:58:06.680Z	V0	Warning: VSphereDatacenterConfig configured in insecure mode
2022-05-02T01:58:06.714Z	V0	✅ Connected to server
2022-05-02T01:58:07.068Z	V0	✅ Authenticated to vSphere
2022-05-02T01:58:07.455Z	V0	✅ Datacenter validated
2022-05-02T01:58:07.784Z	V0	✅ Network validated
2022-05-02T01:58:10.172Z	V0	✅ Datastore validated
2022-05-02T01:58:10.479Z	V0	✅ Folder validated
2022-05-02T01:58:10.804Z	V0	✅ Resource pool validated
2022-05-02T01:58:11.123Z	V0	✅ Datastore validated
2022-05-02T01:58:11.455Z	V0	✅ Folder validated
2022-05-02T01:58:11.767Z	V0	✅ Resource pool validated
2022-05-02T01:58:12.075Z	V0	✅ Datastore validated
2022-05-02T01:58:12.435Z	V0	✅ Folder validated
2022-05-02T01:58:12.760Z	V0	✅ Resource pool validated
2022-05-02T01:58:13.472Z	V0	✅ Control plane and Workload templates validated
2022-05-02T01:58:16.932Z	V0	✅ Vsphere Provider setup is valid
2022-05-02T01:58:17.041Z	V0	✅ Flux path
2022-05-02T01:58:17.041Z	V0	✅ Validate certificate for registry mirror
2022-05-02T01:58:17.041Z	V0	✅ Create preflight validations pass
2022-05-02T01:58:17.041Z	V4	Task finished	{"task_name": "setup-validate", "duration": "10.361226751s"}
2022-05-02T01:58:17.041Z	V4	----------------------------------
2022-05-02T01:58:17.041Z	V4	Task start	{"task_name": "bootstrap-cluster-init"}
2022-05-02T01:58:17.041Z	V0	Creating new bootstrap cluster
2022-05-02T01:58:17.042Z	V4	Creating kind cluster	{"name": "main-i-0e227bf076540da53-eks-a-cluster", "kubeconfig": "main-i-0e227bf076540da53/generated/main-i-0e227bf076540da53.kind.kubeconfig"}
2022-05-02T01:59:23.040Z	V0	Provider specific pre-capi-install-setup on bootstrap cluster
2022-05-02T01:59:23.040Z	V0	Installing cluster-api providers on bootstrap cluster
2022-05-02T02:00:31.271Z	V0	Provider specific post-setup
2022-05-02T02:00:31.271Z	V4	Task finished	{"task_name": "bootstrap-cluster-init", "duration": "2m14.230062367s"}
2022-05-02T02:00:31.271Z	V4	----------------------------------
2022-05-02T02:00:31.271Z	V4	Task start	{"task_name": "workload-cluster-init"}
2022-05-02T02:00:31.271Z	V0	Creating new workload cluster
2022-05-02T02:00:34.009Z	V3	Waiting for external etcd to be ready	{"cluster": "main-i-0e227bf076540da53"}
2022-05-02T02:02:04.876Z	V3	External etcd is ready
2022-05-02T02:02:04.877Z	V3	Waiting for control plane to be ready
2022-05-02T02:05:03.065Z	V3	Waiting for workload kubeconfig generation	{"cluster": "main-i-0e227bf076540da53"}
2022-05-02T02:05:03.457Z	V3	Waiting for controlplane and worker machines to be ready
2022-05-02T02:05:03.797Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:04.108Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:06.525Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:08.912Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:11.272Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:13.677Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:16.098Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:18.489Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:20.836Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:23.202Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:25.545Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:27.906Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:30.268Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:32.637Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:34.957Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:37.365Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:39.731Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:42.093Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:44.474Z	V4	Nodes are not ready yet	{"total": 2, "ready": 0, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:46.858Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:48.185Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:49.507Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:50.859Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:52.210Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:53.619Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:54.972Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:56.320Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:57.649Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:05:58.962Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:00.359Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:01.754Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:03.115Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:04.463Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:05.880Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:07.215Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:08.548Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:09.892Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:11.242Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:12.596Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:13.972Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:15.321Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:16.662Z	V4	Nodes are not ready yet	{"total": 2, "ready": 1, "cluster name": "main-i-0e227bf076540da53"}
2022-05-02T02:06:18.009Z	V4	Nodes ready	{"total": 2}
2022-05-02T02:06:18.009Z	V0	Installing networking on workload cluster
2022-05-02T02:06:21.461Z	V0	Installing storage class on cluster
2022-05-02T02:06:21.943Z	V0	Installing cluster-api providers on workload cluster
2022-05-02T02:08:08.397Z	V0	Installing EKS-A secrets on workload cluster
2022-05-02T02:08:13.062Z	V4	Installing machine health checks on bootstrap cluster
2022-05-02T02:08:13.686Z	V4	Task finished	{"task_name": "workload-cluster-init", "duration": "7m42.414851929s"}
2022-05-02T02:08:13.686Z	V4	----------------------------------
2022-05-02T02:08:13.686Z	V4	Task start	{"task_name": "capi-management-move"}
2022-05-02T02:08:13.686Z	V0	Moving cluster management from bootstrap to workload cluster
2022-05-02T02:08:13.686Z	V3	Waiting for management machines to be ready before move
2022-05-02T02:08:14.104Z	V4	Nodes ready	{"total": 2}
2022-05-02T02:08:25.026Z	V3	Waiting for control planes to be ready after move
2022-05-02T02:08:31.484Z	V3	Waiting for workload cluster control plane replicas to be ready after move
2022-05-02T02:08:32.131Z	V3	Waiting for workload cluster machine deployment replicas to be ready after move
2022-05-02T02:08:32.800Z	V3	Waiting for machines to be ready after move
2022-05-02T02:08:33.172Z	V4	Nodes ready	{"total": 2}
2022-05-02T02:08:33.172Z	V4	Task finished	{"task_name": "capi-management-move", "duration": "19.485943225s"}
2022-05-02T02:08:33.172Z	V4	----------------------------------
2022-05-02T02:08:33.172Z	V4	Task start	{"task_name": "eksa-components-install"}
2022-05-02T02:08:33.172Z	V0	Installing EKS-A custom components (CRD and controller) on workload cluster
2022-05-02T02:09:02.757Z	V0	Installing EKS-D components on workload cluster
2022-05-02T02:09:06.493Z	V0	Creating EKS-A CRDs instances on workload cluster
2022-05-02T02:09:06.498Z	V4	Applying eksa yaml resources to cluster
2022-05-02T02:09:07.892Z	V1	Applying Bundles to cluster
2022-05-02T02:09:08.752Z	V4	Applying eksd manifest to cluster
2022-05-02T02:09:13.312Z	V4	Task finished	{"task_name": "eksa-components-install", "duration": "40.139460455s"}
2022-05-02T02:09:13.312Z	V4	----------------------------------
2022-05-02T02:09:13.312Z	V4	Task start	{"task_name": "addon-manager-install"}
2022-05-02T02:09:13.312Z	V0	Installing AddonManager and GitOps Toolkit on workload cluster
2022-05-02T02:09:13.312Z	V0	Adding cluster configuration files to Git
2022-05-02T02:09:13.312Z	V3	Describing Github repository	{"name": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:09:13.312Z	V3	Describing Github repository	{"name": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:09:13.456Z	V3	Remote Github repo does not exist; will create and initialize	{"repo": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:09:13.456Z	V3	Creating remote Github repo	{"options": {"Name":"spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78","Owner":"that-jetpack-guy","Description":"EKS-A cluster configuration repository","Personal":true,"Privacy":true}}
2022-05-02T02:09:13.456Z	V3	Attempting to create new Github repo	{"repo": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:09:14.385Z	V3	Successfully created new Github repo	{"repo": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:09:14.386Z	V3	Opening directory	{"directory": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:14.386Z	V3	Opening working tree
2022-05-02T02:09:14.386Z	V3	Generating Commit object...
2022-05-02T02:09:14.390Z	V3	Committing Object to local repo	{"repo": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:14.390Z	V0	Finalized commit and committed to local repository	{"hash": "3ee514a5087ddb040ce19e51dae5a337f606a8e1"}
2022-05-02T02:09:14.391Z	V3	Branch does not exist locally	{"branch": "main"}
2022-05-02T02:09:14.560Z	V3	Generating eks-a cluster manifest files...
2022-05-02T02:09:14.560Z	V3	Generating eks-a cluster config file...
2022-05-02T02:09:14.564Z	V3	Generating eks-a kustomization file...
2022-05-02T02:09:14.564Z	V3	Generating flux custom manifest files...
2022-05-02T02:09:14.564Z	V3	Generating flux-system kustomization file...
2022-05-02T02:09:14.564Z	V3	Generating flux-system sync file...
2022-05-02T02:09:14.564Z	V3	Generating flux-system patch file...
2022-05-02T02:09:14.565Z	V3	Opening directory	{"directory": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:14.565Z	V3	Opening working tree
2022-05-02T02:09:14.565Z	V3	Tracking specified files	{"file": "."}
2022-05-02T02:09:14.575Z	V3	Opening directory	{"directory": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:14.575Z	V3	Opening working tree
2022-05-02T02:09:14.575Z	V3	Generating Commit object...
2022-05-02T02:09:14.579Z	V3	Committing Object to local repo	{"repo": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:14.579Z	V0	Finalized commit and committed to local repository	{"hash": "209ec02d1680f13809f639067845b1045a935ee8"}
2022-05-02T02:09:14.579Z	V3	Pushing to remote	{"repo": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:15.125Z	V3	Finished pushing cluster config and flux custom manifest files to git	{"repository": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78"}
2022-05-02T02:09:15.125Z	V4	Checking validity of Github Access Token environment variable	{"env var": "EKSA_GITHUB_TOKEN"}
2022-05-02T02:09:47.802Z	V3	pulling from remote after Flux Bootstrap to ensure configuration files in local git repository are in sync	{"remote": "origin", "branch": "main"}
2022-05-02T02:09:47.802Z	V3	Pulling from remote	{"repo": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "remote": "origin"}
2022-05-02T02:09:48.070Z	V3	Successfully pulled from remote	{"repo": "main-i-0e227bf076540da53/git/spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "remote": "origin", "latest commit": "f8673c15b45433fc1fda2071d4ece61abfd80304"}
2022-05-02T02:09:48.070Z	V4	Task finished	{"task_name": "addon-manager-install", "duration": "34.758108331s"}
2022-05-02T02:09:48.070Z	V4	----------------------------------
2022-05-02T02:09:48.070Z	V4	Task start	{"task_name": "write-cluster-config"}
2022-05-02T02:09:48.070Z	V0	Writing cluster config file
2022-05-02T02:09:48.073Z	V4	Task finished	{"task_name": "write-cluster-config", "duration": "3.237294ms"}
2022-05-02T02:09:48.073Z	V4	----------------------------------
2022-05-02T02:09:48.073Z	V4	Task start	{"task_name": "delete-kind-cluster"}
2022-05-02T02:09:48.073Z	V0	Deleting bootstrap cluster
2022-05-02T02:09:49.399Z	V4	Deleting kind cluster	{"name": "main-i-0e227bf076540da53-eks-a-cluster"}
2022-05-02T02:09:51.088Z	V0	🎉 Cluster created!
2022-05-02T02:09:51.088Z	V4	Task finished	{"task_name": "delete-kind-cluster", "duration": "3.015145179s"}
2022-05-02T02:09:51.088Z	V4	----------------------------------
2022-05-02T02:09:51.088Z	V4	Tasks completed	{"duration": "11m44.408328846s"}
2022-05-02T02:09:51.090Z	V3	Logging out from current govc session
2022-05-02T02:09:51.796Z	V3	Cleaning up long running container	{"name": "eksa_1651456676846185743"}
    cluster.go:499: Running shell command [ eksctl anywhere upgrade cluster -f main-i-0e227bf076540da53-config/cluster.yaml -v 4 ]
2022-05-02T02:09:51.990Z	V4	Logger init completed	{"vlevel": 4}
2022-05-02T02:09:52.083Z	V0	Warning: The recommended size of an external etcd cluster is 3 or 5
2022-05-02T02:09:52.086Z	V0	Warning: VSphereDatacenterConfig configured in insecure mode
2022-05-02T02:09:52.130Z	V4	Reading bundles manifest	{"url": "https://dev-release-prod-pdx.s3.amazonaws.com/bundle-release.yaml"}
2022-05-02T02:09:52.267Z	V2	Pulling docker image	{"image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.7.2-eks-a-v0.0.0-dev-build.1872"}
2022-05-02T02:09:53.246Z	V3	Initializing long running container	{"name": "eksa_1651457392267621229", "image": "public.ecr.aws/l0g8r8j6/eks-anywhere-cli-tools:v0.7.2-eks-a-v0.0.0-dev-build.1872"}
2022-05-02T02:09:53.689Z	V4	Checking validity of Github Access Token environment variable	{"env var": "EKSA_GITHUB_TOKEN"}
2022-05-02T02:09:54.004Z	V0	Checking Github Access Token permissions
2022-05-02T02:09:54.004Z	V0	✅ Github personal access token has the required repo permissions
2022-05-02T02:09:54.004Z	V4	Task start	{"task_name": "setup-and-validate"}
2022-05-02T02:09:54.004Z	V0	Performing setup and validations
2022-05-02T02:09:54.004Z	V0	Warning: VSphereDatacenterConfig configured in insecure mode
2022-05-02T02:09:54.052Z	V0	✅ Connected to server
2022-05-02T02:09:54.388Z	V0	✅ Authenticated to vSphere
2022-05-02T02:09:54.975Z	V0	✅ Datacenter validated
2022-05-02T02:09:55.409Z	V0	✅ Network validated
2022-05-02T02:09:58.666Z	V0	✅ Datastore validated
2022-05-02T02:09:59.125Z	V0	✅ Folder validated
2022-05-02T02:09:59.603Z	V0	✅ Resource pool validated
2022-05-02T02:10:00.045Z	V0	✅ Datastore validated
2022-05-02T02:10:00.540Z	V0	✅ Folder validated
2022-05-02T02:10:01.031Z	V0	✅ Resource pool validated
2022-05-02T02:10:01.485Z	V0	✅ Datastore validated
2022-05-02T02:10:02.006Z	V0	✅ Folder validated
2022-05-02T02:10:02.551Z	V0	✅ Resource pool validated
2022-05-02T02:10:03.559Z	V1	Control plane template validation failed.
2022-05-02T02:10:03.559Z	V0	❌ Validation failed	{"validation": "vsphere Provider setup is valid", "error": "template /SDDC-Datacenter/vm/Templates/bottlerocket-kube-v1-22 is missing tag eksdRelease:kubernetes-1-22-eks-6", "remediation": ""}
2022-05-02T02:10:07.501Z	V3	calculating version differences	{"inputVersion": "1.22", "clusterVersion": "1.21.9-eks-bbc8a0c"}
2022-05-02T02:10:07.501Z	V3	calculated version differences	{"majorVersionDifference": 0, "minorVersionDifference": 1}
2022-05-02T02:10:12.143Z	V0	✅ Validate certificate for registry mirror
2022-05-02T02:10:12.143Z	V0	✅ Control plane ready
2022-05-02T02:10:12.143Z	V0	✅ Worker nodes ready
2022-05-02T02:10:12.143Z	V0	✅ Nodes ready
2022-05-02T02:10:12.143Z	V0	✅ Cluster CRDs ready
2022-05-02T02:10:12.143Z	V0	✅ Cluster object present on workload cluster
2022-05-02T02:10:12.143Z	V0	✅ Upgrade cluster kubernetes version increment
2022-05-02T02:10:12.143Z	V0	✅ Validate immutable fields
2022-05-02T02:10:12.143Z	V0	✅ Upgrade preflight validations pass
2022-05-02T02:10:12.143Z	V4	Task finished	{"task_name": "setup-and-validate", "duration": "18.138433631s"}
2022-05-02T02:10:12.143Z	V4	----------------------------------
2022-05-02T02:10:12.143Z	V4	Tasks completed	{"duration": "18.138460782s"}
2022-05-02T02:10:12.143Z	V3	Logging out from current govc session
2022-05-02T02:10:12.882Z	V3	Cleaning up long running container	{"name": "eksa_1651457392267621229"}
Error: failed to upgrade cluster: validations failed
    cluster.go:532: Command eksctl anywhere [upgrade cluster -f main-i-0e227bf076540da53-config/cluster.yaml -v 4] failed with error: exit status 255: Error: failed to upgrade cluster: validations failed
2022-05-02T02:10:13.022Z	V4	e2e	Checking validity of Github Access Token environment variable	{"env var": "EKSA_GITHUB_TOKEN"}
2022-05-02T02:10:13.299Z	V0	e2e	Checking Github Access Token permissions
2022-05-02T02:10:13.299Z	V0	e2e	✅ Github personal access token has the required repo permissions
2022-05-02T02:10:13.299Z	V3	e2e	Describing Github repository	{"name": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:10:13.299Z	V3	e2e	Describing Github repository	{"name": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:10:13.449Z	V3	e2e	Deleting Github repository	{"name": "spacecraft-aws-eks-anywhere-test-0bed5a33-d5ad-4e31-9136-7417857631a0-78", "owner": "that-jetpack-guy"}
2022-05-02T02:10:13.775Z	V3	e2e	Cleaning up long running container	{"name": "eksa_1651456671054913177"}
2022-05-02T02:10:13.867Z	V3	e2e	Logging out from current govc session
2022-05-02T02:10:14.550Z	V3	e2e	Cleaning up long running container	{"name": "eksa_1651456657929825487"}
--- FAIL: TestVSphereKubernetes121BottlerocketTo122WithFluxLegacyUpgrade (756.77s)
FAIL

DONE 1 tests, 1 failure in 756.902s