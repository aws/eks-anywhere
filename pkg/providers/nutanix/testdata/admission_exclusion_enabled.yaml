apiVersion: controlplane.cluster.x-k8s.io/v1beta1
kind: KubeadmControlPlane
metadata:
  name: eksa-unit-test
spec:
  rolloutStrategy:
    rollingUpdate:
      maxSurge: 1
    type: RollingUpdate
  kubeadmConfigSpec:
    clusterConfiguration:
      apiServer:
        extraEnvs:
        - name: EKS_PATCH_EXCLUSION_RULES_FILE
          value: /etc/kubernetes/admission-plugin-exclusion-rules.json
        extraVolumes:
        - name: admission-exclusion-rules
          hostPath: /etc/kubernetes/admission-plugin-exclusion-rules.json
          mountPath: /etc/kubernetes/admission-plugin-exclusion-rules.json
          pathType: File
          readOnly: true
    files:
    - path: /etc/kubernetes/admission-plugin-exclusion-rules.json
      owner: root:root
